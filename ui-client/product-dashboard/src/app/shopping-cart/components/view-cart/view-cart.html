<div class="view-cart-container">
  <div class="cart-header">
    <h1>Shopping Cart</h1>
    @if (!isEmpty()) {
    <p class="cart-summary">
      {{ totalItems() }} item{{ totalItems() !== 1 ? 's' : '' }} in your cart
    </p>
    }
  </div>

  @if (isEmpty()) {
  <mat-card class="empty-cart-card">
    <mat-card-content>
      <div class="empty-cart-content">
        <mat-icon class="empty-cart-icon">shopping_cart</mat-icon>
        <h2>Your cart is empty</h2>
        <p>Add some products to your cart to get started</p>
        <button mat-raised-button color="primary" routerLink="/products">
          <mat-icon>shopping_bag</mat-icon>
          Browse Products
        </button>
      </div>
    </mat-card-content>
  </mat-card>
  } @else {
  <div class="cart-content">
    <div class="cart-items">
      @for (item of cartItems(); track item.product.id) {
      <mat-card class="cart-item-card">
        <div class="cart-item-content">
          @if (item.product.image_url) {
          <img
            [src]="item.product.image_url"
            [alt]="item.product.title"
            class="product-image"
          />
          } @else {
          <div class="product-image-placeholder">
            <mat-icon>image</mat-icon>
          </div>
          }

          <div class="product-details">
            <a [routerLink]="['/products/details', item.product.id]">
              <h3 class="product-title">{{ item.product.title }}</h3>
            </a>
            @if (item.product.category_name) {
            <p class="product-category">{{ item.product.category_name }}</p>
            }
            <!-- <p class="product-price">{{ item.product.price | currency }}</p> -->
          </div>

          <div class="quantity-controls">
            <button
              mat-icon-button
              color="primary"
              (click)="decreaseQuantity(item.product.id)"
              aria-label="Decrease quantity"
            >
              <mat-icon>remove</mat-icon>
            </button>
            <span class="quantity-display">{{ item.quantity }}</span>
            <button
              mat-icon-button
              color="primary"
              (click)="increaseQuantity(item.product.id)"
              aria-label="Increase quantity"
            >
              <mat-icon>add</mat-icon>
            </button>
          </div>

          <div class="item-total">
            <p class="item-total-price">
              {{ getItemTotal(item.product.price, item.quantity) | currency }}
            </p>
          </div>

          <button
            mat-icon-button
            color="warn"
            (click)="removeItem(item.product.id)"
            aria-label="Remove item"
            class="remove-button"
          >
            <mat-icon>delete</mat-icon>
          </button>
        </div>
      </mat-card>
      }
    </div>

    <mat-card class="order-summary-card">
      <mat-card-header>
        <mat-card-title>Order Summary</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="summary-row">
          <span
            >Subtotal ({{ totalItems() }} item{{ totalItems() !== 1 ? 's' : ''
            }})</span
          >
          <span>{{ totalAmount() | currency }}</span>
        </div>
        <div class="summary-row">
          <span>Shipping</span>
          <span>Free</span>
        </div>
        <div class="summary-row total-row">
          <span>Total</span>
          <span class="total-amount">{{ totalAmount() | currency }}</span>
        </div>
      </mat-card-content>
      <mat-card-actions>
        <button
          mat-raised-button
          color="primary"
          class="place-order-button"
          (click)="placeOrder()"
        >
          <mat-icon>shopping_cart_checkout</mat-icon>
          Place Order
        </button>
        <button
          mat-button
          color="primary"
          routerLink="/products"
          class="continue-shopping-button"
        >
          Continue Shopping
        </button>
      </mat-card-actions>
    </mat-card>
  </div>
  }
</div>
